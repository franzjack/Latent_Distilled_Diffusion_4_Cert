Namespace(config='base.yaml', device='cuda:0', seed=807, testmissingratio=-1.0, nfold=0, target_dim=2, eval_length=2, model_name='MNIST', unconditional=False, modelfolder='', nsample=1, ntrajs=1, nepochs=2000, batch_size=128, lr=0.0001, scaling_flag=True, q=0.9, load=False, rob_flag=False, active_flag=False, implicit_flag=True, map_type='MNIST', gamma=0.0)
False
False
{
    "train": {
        "epochs": 2000,
        "batch_size": 128,
        "lr": 0.0001
    },
    "diffusion": {
        "layers": 4,
        "channels": 32,
        "nheads": 8,
        "diffusion_embedding_dim": 2,
        "beta_start": 0.0001,
        "beta_end": 0.5,
        "num_steps": 16,
        "schedule": "quad",
        "input_dim": 2,
        "traj_len": 2,
        "gamma": 0.0
    },
    "model": {
        "is_unconditional": false,
        "timeemb": 64,
        "featureemb": 64,
        "target_strategy": "test",
        "test_missing_ratio": -1.0
    }
}
model folder: ./save/MNIST/DIFF/ID_UNC75/
target dim is:  2
Autoencoder loaded from: ./save/VAE/VAE_401/vae_model.pth

✨ Best validation loss updated to 6982.0043 at epoch 5

✨ Best validation loss updated to 6943.8934 at epoch 10

✨ Best validation loss updated to 6927.3431 at epoch 15

✨ Best validation loss updated to 6922.9946 at epoch 60

✨ Best validation loss updated to 6883.2312 at epoch 65

✨ Best validation loss updated to 6873.1855 at epoch 210

✨ Best validation loss updated to 6846.9098 at epoch 230

✨ Best validation loss updated to 6484.6790 at epoch 235

✨ Best validation loss updated to 6376.8345 at epoch 240

✨ Best validation loss updated to 6329.8785 at epoch 245

✨ Best validation loss updated to 6245.8418 at epoch 255

✨ Best validation loss updated to 6237.8983 at epoch 265

✨ Best validation loss updated to 6226.9029 at epoch 275

✨ Best validation loss updated to 6194.5400 at epoch 285

✨ Best validation loss updated to 6172.7231 at epoch 310

✨ Best validation loss updated to 6134.8851 at epoch 320

✨ Best validation loss updated to 6134.2805 at epoch 345

✨ Best validation loss updated to 6104.8133 at epoch 365

✨ Best validation loss updated to 6094.7754 at epoch 375

✨ Best validation loss updated to 6068.5470 at epoch 380

✨ Best validation loss updated to 6020.2693 at epoch 385

✨ Best validation loss updated to 6012.2463 at epoch 400

✨ Best validation loss updated to 5987.9514 at epoch 410

✨ Best validation loss updated to 5933.7583 at epoch 425

✨ Best validation loss updated to 5892.0361 at epoch 430

✨ Best validation loss updated to 5869.5069 at epoch 445

✨ Best validation loss updated to 5851.9114 at epoch 450

✨ Best validation loss updated to 5850.8535 at epoch 470

✨ Best validation loss updated to 5810.1324 at epoch 475

✨ Best validation loss updated to 5803.6408 at epoch 490

✨ Best validation loss updated to 5774.3085 at epoch 500

✨ Best validation loss updated to 5749.7103 at epoch 530

✨ Best validation loss updated to 5744.4540 at epoch 555

✨ Best validation loss updated to 5729.8379 at epoch 585

✨ Best validation loss updated to 5710.1303 at epoch 590

✨ Best validation loss updated to 5683.2624 at epoch 680

✨ Best validation loss updated to 5682.4788 at epoch 700

✨ Best validation loss updated to 5677.7747 at epoch 725

✨ Best validation loss updated to 5674.2680 at epoch 825

✨ Best validation loss updated to 5663.7146 at epoch 865

✨ Best validation loss updated to 5661.1001 at epoch 940

✨ Best validation loss updated to 5630.4848 at epoch 945

✨ Best validation loss updated to 5620.1644 at epoch 985

✨ Best validation loss updated to 5584.6141 at epoch 1005

✨ Best validation loss updated to 5576.3947 at epoch 1025

✨ Best validation loss updated to 5559.8204 at epoch 1065

✨ Best validation loss updated to 5559.1663 at epoch 1105

✨ Best validation loss updated to 5548.4486 at epoch 1120

✨ Best validation loss updated to 5548.0177 at epoch 1180

✨ Best validation loss updated to 5529.8644 at epoch 1380

✨ Best validation loss updated to 5526.7886 at epoch 1495

✨ Best validation loss updated to 5511.7991 at epoch 1665
Training time:  32007.758056402206
evaluation using the implicit version of the forward process for model
Evaluation using the implicit version of the model over the test dataset...
Plotting images...
samples len is:  157
target len is:  157
samples shape is:  torch.Size([64, 1, 1, 2])
target shape is:  torch.Size([64, 1, 2])
N is: 157
M is: 64
Plotting images...
samples len is:  157
target len is:  157
samples shape is:  torch.Size([64, 1, 1, 2])
target shape is:  torch.Size([64, 1, 2])
N is: 157
M is: 64
process terminated for model: 75
