Namespace(config='base.yaml', device='cuda:0', seed=625, model_seed='1', testmissingratio=-1.0, nfold=0, target_dim=2, eval_length=24, model_name='MNIST', unconditional=False, teacher_folder='', student_folder='', modelfolder='75', nsample=1, ntrajs=1, nepochs=1000, batch_size=128, lr=0.0005, scaling_flag=True, q=0.9, load=False, rob_flag=False, active_flag=False, implicit_flag=True, map_type='MNIST', gamma=0.0)
False
False
Autoencoder loaded from: ./save/VAE/VAE_401/vae_model.pth
student num_steps: 8
batch size is 128
quad
{
    "train": {
        "epochs": 1000,
        "batch_size": 128,
        "lr": 0.0005
    },
    "diffusion": {
        "layers": 4,
        "channels": 32,
        "nheads": 8,
        "diffusion_embedding_dim": 2,
        "beta_start": 0.0001,
        "beta_end": 0.5,
        "num_steps": 8,
        "schedule": "student",
        "input_dim": 2,
        "traj_len": 24,
        "gamma": 0.0
    },
    "model": {
        "is_unconditional": false,
        "timeemb": 64,
        "featureemb": 64,
        "target_strategy": "test",
        "test_missing_ratio": -1.0
    }
}
model folder: ./save/MNIST/DIFF/ID_UNC75/distill_8/
teacher alphas tensor([[[0.9999]],

        [[0.9967]],

        [[0.9861]],

        [[0.9641]],

        [[0.9271]],

        [[0.8727]],

        [[0.7999]],

        [[0.7099]],

        [[0.6064]],

        [[0.4952]],

        [[0.3836]],

        [[0.2794]],

        [[0.1894]],

        [[0.1179]],

        [[0.0665]],

        [[0.0332]]], device='cuda:0')
student alphas tensor([[[0.9999]],

        [[0.9861]],

        [[0.9271]],

        [[0.7999]],

        [[0.6064]],

        [[0.3836]],

        [[0.1894]],

        [[0.0665]]], device='cuda:0')

✨ Best valid loss updated to 0.0229 at epoch 4

✨ Best valid loss updated to 0.0180 at epoch 8

✨ Best valid loss updated to 0.0159 at epoch 12

✨ Best valid loss updated to 0.0126 at epoch 20

✨ Best valid loss updated to 0.0114 at epoch 28

✨ Best valid loss updated to 0.0111 at epoch 36

✨ Best valid loss updated to 0.0111 at epoch 40

✨ Best valid loss updated to 0.0101 at epoch 56

✨ Best valid loss updated to 0.0096 at epoch 68

✨ Best valid loss updated to 0.0095 at epoch 112

✨ Best valid loss updated to 0.0084 at epoch 212

✨ Best valid loss updated to 0.0078 at epoch 240
Training time:  23119.405132055283
8
evaluation using the implicit version of the forward process for model
Evaluation using student and teacher over the test dataset...
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([64, 2, 1])
xx shape is:  torch.Size([16, 2, 1])
Plotting student vs teacher reconstructions...
student samples len: 157
teacher samples len: 157
student sample shape: torch.Size([64, 1, 1, 2])
teacher sample shape: torch.Size([64, 1, 1, 2])
Number of comparisons: 64
process terminated for model: 30
